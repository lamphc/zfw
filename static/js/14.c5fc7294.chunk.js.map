{"version":3,"sources":["pages/Rent/Search/index.module.css","pages/Rent/Search/index.js"],"names":["module","exports","Search","state","searchTxt","tipsList","handlerSearch","val","_val","trim","length","setState","a","getCommunity","cityId","status","data","renderTips","map","item","onClick","props","history","replace","pathname","id","community","name","communityName","key","className","styles","tip","getCurCity","value","this","root","placeholder","onChange","showCancelButton","onCancel","tips","Component"],"mappings":"gFACAA,EAAOC,QAAU,CAAC,KAAO,qBAAqB,KAAO,qBAAqB,UAAY,0BAA0B,KAAO,qBAAqB,IAAM,sB,wNCQ7HC,E,4MAEnBC,MAAQ,CAENC,UAAW,GAEXC,SAAU,I,EAIZC,cAAgB,SAACC,GACf,IAAIC,EAAOD,EAAIE,OAEf,GAAoB,IAAhBD,EAAKE,OACP,OAAO,EAAKC,SAAS,CACnBP,UAAW,GACXC,SAAU,KAId,EAAKM,SAAS,CACZP,UAAWI,GADb,sBAEG,gCAAAI,EAAA,sEAE8BC,YAAa,EAAKC,OAAQN,GAFxD,gBAEOO,EAFP,EAEOA,OAAQC,EAFf,EAEeA,KACD,MAAXD,GAEF,EAAKJ,SAAS,CACZN,SAAUW,IANb,6C,EAmBLC,WAAa,WAGX,OAFqB,EAAKd,MAAlBE,SAEQa,KAAI,SAAAC,GAAI,OACtB,wBAAIC,QAAS,WACX,EAAKC,MAAMC,QAAQC,QAAQ,CAAEC,SAAU,YAAaR,KAAM,CAAES,GAAIN,EAAKO,UAAWC,KAAMR,EAAKS,kBAC1FC,IAAKV,EAAKO,UAAWI,UAAWC,IAAOC,KACvCb,EAAKS,mB,oMAZcK,c,gBAAhBC,E,EAAAA,MACRC,KAAKrB,OAASoB,E,qIAgBN,IACAZ,EAAYa,KAAKd,MAAjBC,QACAlB,EAAc+B,KAAKhC,MAAnBC,UAER,OACE,yBAAK0B,UAAWC,IAAOK,MAErB,uBACEC,YAAY,mDACZH,MAAO9B,EACPkC,SAAUH,KAAK7B,cACfiC,kBAAkB,EAClBC,SAAU,kBAAMlB,EAAQC,QAAQ,gBAIlC,wBAAIO,UAAWC,IAAOU,MAAON,KAAKlB,mB,GArENyB","file":"static/js/14.c5fc7294.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Search_root__1RO5f\",\"list\":\"Search_list__2aU3H\",\"noHistory\":\"Search_noHistory__1jsXM\",\"tips\":\"Search_tips__1_3KG\",\"tip\":\"Search_tip__V0T8K\"};","import React, { Component } from 'react'\r\n\r\nimport { SearchBar } from 'antd-mobile'\r\n\r\nimport { getCurCity } from '../../../utils'\r\n\r\nimport styles from './index.module.css'\r\nimport { getCommunity } from '../../../utils/api/City'\r\n\r\nexport default class Search extends Component {\r\n\r\n  state = {\r\n    // 搜索框的值\r\n    searchTxt: '',\r\n    // 小区列表\r\n    tipsList: []\r\n  }\r\n\r\n  // 搜索框受控（双向绑定）\r\n  handlerSearch = (val) => {\r\n    let _val = val.trim();\r\n    // 处理为空的情况\r\n    if (_val.length === 0) {\r\n      return this.setState({\r\n        searchTxt: '',\r\n        tipsList: []\r\n      })\r\n    }\r\n    // 正常\r\n    this.setState({\r\n      searchTxt: _val\r\n    }, async () => {\r\n      // 根据关键词搜索小区\r\n      const { status, data } = await getCommunity(this.cityId, _val);\r\n      if (status === 200) {\r\n        // 显示搜索结果\r\n        this.setState({\r\n          tipsList: data\r\n        })\r\n      }\r\n    })\r\n  }\r\n\r\n  async componentDidMount() {\r\n    // 获取城市ID\r\n    const { value } = await getCurCity();\r\n    this.cityId = value;\r\n  }\r\n\r\n  // 渲染搜索结果列表\r\n  renderTips = () => {\r\n    const { tipsList } = this.state\r\n\r\n    return tipsList.map(item => (\r\n      <li onClick={() => {\r\n        this.props.history.replace({ pathname: '/rent/add', data: { id: item.community, name: item.communityName } })\r\n      }} key={item.community} className={styles.tip}>\r\n        {item.communityName}\r\n      </li>\r\n    ))\r\n  }\r\n\r\n  render() {\r\n    const { history } = this.props\r\n    const { searchTxt } = this.state\r\n\r\n    return (\r\n      <div className={styles.root}>\r\n        {/* 搜索框 */}\r\n        <SearchBar\r\n          placeholder=\"请输入小区或地址\"\r\n          value={searchTxt}\r\n          onChange={this.handlerSearch}\r\n          showCancelButton={true}\r\n          onCancel={() => history.replace('/rent/add')}\r\n        />\r\n\r\n        {/* 搜索提示列表 */}\r\n        <ul className={styles.tips}>{this.renderTips()}</ul>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"],"sourceRoot":""}